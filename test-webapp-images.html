<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Web App Images - Kho V·∫£i T√¥n</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: #f8f9fa;
        }
        .header {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-section {
            background: white;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .status { font-weight: bold; padding: 4px 12px; border-radius: 4px; margin-left: 10px; }
        .status.success { background: #d4edda; color: #155724; }
        .status.error { background: #f8d7da; color: #721c24; }
        .status.warning { background: #fff3cd; color: #856404; }
        .fabric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .fabric-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        .fabric-card img {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: 4px;
            border: 1px solid #eee;
        }
        .fabric-code {
            font-weight: bold;
            margin-bottom: 8px;
            color: #333;
        }
        .url-display {
            font-family: monospace;
            font-size: 11px;
            color: #666;
            word-break: break-all;
            margin-top: 5px;
        }
        .loading { color: #6c757d; font-style: italic; }
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover { background: #0056b3; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üß™ Test Web App Images - Kho V·∫£i T√¥n</h1>
        <p>Ki·ªÉm tra ·∫£nh Cloudinary hi·ªÉn th·ªã trong web app sau khi s·ª≠a CloudinaryService</p>
        
        <div>
            <strong>üåê Web App:</strong> 
            <a href="http://localhost:3001" target="_blank">http://localhost:3001</a>
            <span id="webapp-status" class="loading">ƒêang ki·ªÉm tra...</span>
        </div>
        
        <div style="margin-top: 10px;">
            <button class="btn" onclick="testWebApp()">üîÑ Test Web App</button>
            <button class="btn" onclick="testCloudinaryImages()">‚òÅÔ∏è Test Cloudinary Images</button>
            <button class="btn" onclick="openWebApp()">üöÄ M·ªü Web App</button>
        </div>
    </div>

    <div class="test-section">
        <h2>üìä K·∫øt qu·∫£ ki·ªÉm tra</h2>
        <div id="results">
            <div class="loading">Ch∆∞a ch·∫°y test n√†o...</div>
        </div>
    </div>

    <div class="test-section">
        <h2>üñºÔ∏è Test Cloudinary Images</h2>
        <div id="image-results">
            <div class="loading">Ch∆∞a test ·∫£nh...</div>
        </div>
    </div>

    <script>
        const fabricCodes = [
            'AR-071-02B',
            'BERTONE-30', 
            'TP01623-224',
            'DCR-RP1120',
            '71022-10',
            'YB0320-7',
            'M907-12',
            'W5601-6'
        ]

        function createCloudinaryUrl(fabricCode) {
            return `https://res.cloudinary.com/dgaktc3fb/image/upload/fabrics/${fabricCode}.jpg`
        }

        async function testWebApp() {
            const resultsDiv = document.getElementById('results')
            const statusSpan = document.getElementById('webapp-status')
            
            resultsDiv.innerHTML = '<div class="loading">ƒêang test web app...</div>'
            
            try {
                // Test web app connection
                const response = await fetch('http://localhost:3001')
                
                if (response.ok) {
                    statusSpan.innerHTML = '<span class="status success">‚úÖ Online</span>'
                    
                    const html = await response.text()
                    const hasReact = html.includes('React') || html.includes('root')
                    const hasVite = html.includes('vite') || html.includes('module')
                    
                    resultsDiv.innerHTML = `
                        <h3>‚úÖ Web App Connection Test</h3>
                        <p><strong>Status:</strong> ${response.status} ${response.statusText}</p>
                        <p><strong>Content-Type:</strong> ${response.headers.get('content-type')}</p>
                        <p><strong>React App:</strong> ${hasReact ? '‚úÖ Detected' : '‚ùå Not detected'}</p>
                        <p><strong>Vite Build:</strong> ${hasVite ? '‚úÖ Detected' : '‚ùå Not detected'}</p>
                        <p><strong>K·∫øt lu·∫≠n:</strong> Web app ƒëang ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng!</p>
                    `
                } else {
                    statusSpan.innerHTML = '<span class="status error">‚ùå Offline</span>'
                    resultsDiv.innerHTML = `
                        <h3>‚ùå Web App Connection Failed</h3>
                        <p><strong>Status:</strong> ${response.status} ${response.statusText}</p>
                        <p><strong>Khuy·∫øn ngh·ªã:</strong> Ki·ªÉm tra l·∫°i development server</p>
                    `
                }
            } catch (error) {
                statusSpan.innerHTML = '<span class="status error">‚ùå Error</span>'
                resultsDiv.innerHTML = `
                    <h3>‚ùå Web App Connection Error</h3>
                    <p><strong>Error:</strong> ${error.message}</p>
                    <p><strong>Khuy·∫øn ngh·ªã:</strong> Kh·ªüi ƒë·ªông l·∫°i server v·ªõi <code>npm run dev</code></p>
                `
            }
        }

        async function testCloudinaryImages() {
            const imageResultsDiv = document.getElementById('image-results')
            imageResultsDiv.innerHTML = '<div class="loading">ƒêang test ·∫£nh Cloudinary...</div>'
            
            let html = '<h3>‚òÅÔ∏è Cloudinary Images Test</h3><div class="fabric-grid">'
            
            for (const fabricCode of fabricCodes) {
                const url = createCloudinaryUrl(fabricCode)
                
                html += `
                    <div class="fabric-card">
                        <div class="fabric-code">${fabricCode}</div>
                        <img id="img-${fabricCode}" src="${url}" 
                             onload="updateImageStatus('${fabricCode}', true)"
                             onerror="updateImageStatus('${fabricCode}', false)"
                             alt="${fabricCode}">
                        <div id="status-${fabricCode}" class="loading">ƒêang t·∫£i...</div>
                        <div class="url-display">${url}</div>
                    </div>
                `
            }
            
            html += '</div>'
            imageResultsDiv.innerHTML = html
            
            // Test v·ªõi fetch c≈©ng
            let successCount = 0
            for (const fabricCode of fabricCodes) {
                try {
                    const response = await fetch(createCloudinaryUrl(fabricCode), { method: 'HEAD' })
                    if (response.ok) successCount++
                } catch (error) {
                    console.log(`Fetch error for ${fabricCode}: ${error.message}`)
                }
            }
            
            console.log(`Cloudinary Images: ${successCount}/${fabricCodes.length} th√†nh c√¥ng`)
        }

        function updateImageStatus(fabricCode, success) {
            const statusDiv = document.getElementById(`status-${fabricCode}`)
            if (success) {
                statusDiv.innerHTML = '<span class="status success">‚úÖ T·∫£i th√†nh c√¥ng</span>'
            } else {
                statusDiv.innerHTML = '<span class="status error">‚ùå L·ªói t·∫£i ·∫£nh</span>'
            }
        }

        function openWebApp() {
            window.open('http://localhost:3001', '_blank')
        }

        // Auto test khi load trang
        window.onload = function() {
            setTimeout(testWebApp, 1000)
            setTimeout(testCloudinaryImages, 2000)
        }
    </script>
</body>
</html>